<!--
-- Copyright (c) 2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
--
-- NVIDIA CORPORATION, its affiliates and licensors retain all intellectual
-- property and proprietary rights in and to this material, related
-- documentation and any modifications thereto. Any use, reproduction,
-- disclosure or distribution of this material and related documentation
-- without an express license agreement from NVIDIA CORPORATION or
-- its affiliates is strictly prohibited.
-->
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>curobo.opt.opt_base module</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=097e10a7" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            cuRobo
              <img src="../_static/nvidia_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/research/research.html">Technical Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/research/research_using_curobo.html">Research using cuRobo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/1_install_instructions.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/1a_quick_overview.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/2a_python_examples.html">Using in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/2b_isaacsim_examples.html">Using with Isaac Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/2c_world_collision.html">Collision World Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/2d_nvblox_demo.html">Using with Depth Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/2e_torch_layer_example.html">Using in a Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/4_benchmarks.html">Benchmarks &amp; Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/5_docker_development.html">Docker Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/6_known_issues.html">Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/getting_started/7_api.html">Python API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/advanced_examples/1_batch_env.html">Batched Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/advanced_examples/2_block_stacking_example.html">Block Stacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/advanced_examples/3_constrained_planning.html">Constrained Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/advanced_examples/4_robot_segmentation.html">Robot Segmentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/tutorials/1_robot_configuration.html">Configuring a New Robot</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/notes/01_robot_list.html">Supported Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/notes/02_numerical_optimization.html">Numerical Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/notes/04_cuda_kernels.html">CUDA Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/notes/05_usd_api.html">USD for Robot and World Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/notes/07_environment_variables.html">Environment Variables</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cuRobo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">curobo.opt.opt_base module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_api/curobo.opt.opt_base.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-curobo.opt.opt_base">
<span id="curobo-opt-opt-base-module"></span><h1>curobo.opt.opt_base module<a class="headerlink" href="#module-curobo.opt.opt_base" title="Link to this heading"></a></h1>
<p>Base module for Optimization.</p>
<dl class="py class">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">curobo.opt.opt_base.</span></span><span class="sig-name descname"><span class="pre">OptimizerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_lows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_highs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_horizon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cold_start_n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_problems</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_cuda_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_coo_sparse</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for an <a class="reference internal" href="#curobo.opt.opt_base.Optimizer" title="curobo.opt.opt_base.Optimizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Optimizer</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_action</strong> (<em>int</em>) – </p></li>
<li><p><strong>action_lows</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>action_highs</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>action_horizon</strong> (<em>int</em>) – </p></li>
<li><p><strong>horizon</strong> (<em>int</em>) – </p></li>
<li><p><strong>n_iters</strong> (<em>int</em>) – </p></li>
<li><p><strong>cold_start_n_iters</strong> (<em>int</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>rollout_fn</strong> (<a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.RolloutBase" title="curobo.rollout.rollout_base.RolloutBase"><em>RolloutBase</em></a>) – </p></li>
<li><p><strong>tensor_args</strong> (<a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><em>TensorDeviceType</em></a>) – </p></li>
<li><p><strong>use_cuda_graph</strong> (<em>bool</em>) – </p></li>
<li><p><strong>store_debug</strong> (<em>bool</em>) – </p></li>
<li><p><strong>debug_info</strong> (<em>Any</em>) – </p></li>
<li><p><strong>n_problems</strong> (<em>int</em>) – </p></li>
<li><p><strong>num_particles</strong> (<em>int</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>sync_cuda_time</strong> (<em>bool</em>) – </p></li>
<li><p><strong>use_coo_sparse</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.d_action">
<span class="sig-name descname"><span class="pre">d_action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.d_action" title="Link to this definition"></a></dt>
<dd><p>Number of optimization variables per timestep.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.action_lows">
<span class="sig-name descname"><span class="pre">action_lows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.action_lows" title="Link to this definition"></a></dt>
<dd><p>Lower bound for optimization variables.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.action_highs">
<span class="sig-name descname"><span class="pre">action_highs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.action_highs" title="Link to this definition"></a></dt>
<dd><p>Higher bound for optimization variables</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.action_horizon">
<span class="sig-name descname"><span class="pre">action_horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.action_horizon" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.horizon" title="Link to this definition"></a></dt>
<dd><p>Number of timesteps in optimization state, total variables = d_action * horizon</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.n_iters">
<span class="sig-name descname"><span class="pre">n_iters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.n_iters" title="Link to this definition"></a></dt>
<dd><p>Number of iterations to run optimization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.cold_start_n_iters">
<span class="sig-name descname"><span class="pre">cold_start_n_iters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.cold_start_n_iters" title="Link to this definition"></a></dt>
<dd><p>Number of iterations to run optimization during the first instance. Setting to None will
use n_iters. This parameter is useful in MPC like settings where we need to run many
iterations during initialization (cold start) and then run only few iterations (warm start).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.rollout_fn">
<span class="sig-name descname"><span class="pre">rollout_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.RolloutBase" title="curobo.rollout.rollout_base.RolloutBase"><span class="pre">RolloutBase</span></a></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.rollout_fn" title="Link to this definition"></a></dt>
<dd><p>Rollout function to use for computing cost, given optimization variables.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.tensor_args">
<span class="sig-name descname"><span class="pre">tensor_args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><span class="pre">TensorDeviceType</span></a></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.tensor_args" title="Link to this definition"></a></dt>
<dd><p>Tensor device to use for optimization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.use_cuda_graph">
<span class="sig-name descname"><span class="pre">use_cuda_graph</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.use_cuda_graph" title="Link to this definition"></a></dt>
<dd><p>Capture optimization iteration in a cuda graph and replay graph instead of eager execution.
Enabling this can make optimization 10x faster. But changing control flow, tensor
shapes, or problem type is not allowed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.store_debug">
<span class="sig-name descname"><span class="pre">store_debug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.store_debug" title="Link to this definition"></a></dt>
<dd><p>Record debugging data such as optimization variables, and cost at every iteration. Enabling
this will disable cuda graph.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.debug_info">
<span class="sig-name descname"><span class="pre">debug_info</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.debug_info" title="Link to this definition"></a></dt>
<dd><p>Use this to record additional attributes from rollouts.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.n_problems">
<span class="sig-name descname"><span class="pre">n_problems</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.n_problems" title="Link to this definition"></a></dt>
<dd><p>Number of parallel problems to optimize.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.num_particles">
<span class="sig-name descname"><span class="pre">num_particles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.num_particles" title="Link to this definition"></a></dt>
<dd><p>Number of particles to use per problem. Common optimization solvers use many particles to
optimize a single problem. E.g., MPPI rolls out many parallel samples and computes a weighted
mean. In cuRobo, Quasi-Newton solvers use particles to run many line search magnitudes.
Total optimization batch size = n_problems * num_particles.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.sync_cuda_time">
<span class="sig-name descname"><span class="pre">sync_cuda_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.sync_cuda_time" title="Link to this definition"></a></dt>
<dd><p>Synchronize device before computing solver time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.use_coo_sparse">
<span class="sig-name descname"><span class="pre">use_coo_sparse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.use_coo_sparse" title="Link to this definition"></a></dt>
<dd><p>Matmul with a Sparse tensor is used to create particles for each problem index to save memory
and compute. Some versions of pytorch do not support coo sparse, specifically during
torch profile runs. Set this to False to use a standard tensor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.OptimizerConfig.create_data_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_data_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TensorDeviceType(device=device(type='cuda',</span> <span class="pre">index=0),</span> <span class="pre">dtype=torch.float32,</span> <span class="pre">collision_geometry_dtype=torch.float32,</span> <span class="pre">collision_gradient_dtype=torch.float32,</span> <span class="pre">collision_distance_dtype=torch.float32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.OptimizerConfig.create_data_dict" title="Link to this definition"></a></dt>
<dd><p>Helper function to create dictionary from optimizer parameters and rollout class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dict</strong> (<em>Dict</em>) – optimizer parameters dictionary.</p></li>
<li><p><strong>rollout_fn</strong> (<a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.RolloutBase" title="curobo.rollout.rollout_base.RolloutBase"><em>RolloutBase</em></a>) – rollout function.</p></li>
<li><p><strong>tensor_args</strong> (<a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><em>TensorDeviceType</em></a>) – tensor cuda device.</p></li>
<li><p><strong>child_dict</strong> (<em>Dict</em><em> | </em><em>None</em>) – new dictionary where parameters will be stored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with parameters to create a <a class="reference internal" href="#curobo.opt.opt_base.OptimizerConfig" title="curobo.opt.opt_base.OptimizerConfig"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OptimizerConfig</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">curobo.opt.opt_base.</span></span><span class="sig-name descname"><span class="pre">Optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#curobo.opt.opt_base.OptimizerConfig" title="curobo.opt.opt_base.OptimizerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizerConfig</span></code></a></p>
<p>Base optimization solver class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#curobo.opt.opt_base.OptimizerConfig" title="curobo.opt.opt_base.OptimizerConfig"><em>OptimizerConfig</em></a><em>]</em>) – Initialized with parameters from a dataclass.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.optimize" title="Link to this definition"></a></dt>
<dd><p>Find a solution through optimization given the initial values for variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt_tensor</strong> (<em>Tensor</em>) – Initial value of optimization variables.
Shape: [n_problems, action_horizon, d_action]</p></li>
<li><p><strong>shift_steps</strong> – Shift variables along action_horizon. Useful in mpc warm-start setting.</p></li>
<li><p><strong>n_iters</strong> – Override number of iterations to run optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Optimized values returned as a tensor of shape [n_problems, action_horizon, d_action].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.update_params">
<span class="sig-name descname"><span class="pre">update_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">goal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.update_params" title="Link to this definition"></a></dt>
<dd><p>Update parameters in the <a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.RolloutBase" title="curobo.rollout.rollout_base.RolloutBase"><code class="xref py py-meth docutils literal notranslate"><span class="pre">curobo.rollout.rollout_base.RolloutBase</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>goal</strong> (<a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><em>Goal</em></a>) – parameters to update rollout instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.reset" title="Link to this definition"></a></dt>
<dd><p>Reset optimizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.update_nproblems">
<span class="sig-name descname"><span class="pre">update_nproblems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_problems</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.update_nproblems" title="Link to this definition"></a></dt>
<dd><p>Update the number of problems that need to be optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_problems</strong> (<em>int</em>) – number of problems.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.get_nproblem_tensor">
<span class="sig-name descname"><span class="pre">get_nproblem_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.get_nproblem_tensor" title="Link to this definition"></a></dt>
<dd><p>This function takes an input tensor of shape (n_problem,….) and converts it into
(n_particles,…).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.reset_seed">
<span class="sig-name descname"><span class="pre">reset_seed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.reset_seed" title="Link to this definition"></a></dt>
<dd><p>Reset seeds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.reset_cuda_graph">
<span class="sig-name descname"><span class="pre">reset_cuda_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.reset_cuda_graph" title="Link to this definition"></a></dt>
<dd><p>Reset CUDA Graphs. This does not work, workaround is to create a new instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.reset_shape">
<span class="sig-name descname"><span class="pre">reset_shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.reset_shape" title="Link to this definition"></a></dt>
<dd><p>Reset any flags in rollout class. Useful to reinitialize tensors for a new shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer.get_all_rollout_instances">
<span class="sig-name descname"><span class="pre">get_all_rollout_instances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer.get_all_rollout_instances" title="Link to this definition"></a></dt>
<dd><p>Get all instances of Rollout class in the optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.RolloutBase" title="curobo.rollout.rollout_base.RolloutBase"><em>RolloutBase</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer._optimize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer._optimize" title="Link to this definition"></a></dt>
<dd><p>Implement this function in a derived class containing the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt_tensor</strong> (<em>Tensor</em>) – Initial value of optimization variables.
Shape: [n_problems, action_horizon, d_action]</p></li>
<li><p><strong>shift_steps</strong> – Shift variables along action_horizon. Useful in mpc warm-start setting.</p></li>
<li><p><strong>n_iters</strong> – Override number of iterations to run optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Optimized variables in tensor shape [action_horizon, d_action].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer._shift">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer._shift" title="Link to this definition"></a></dt>
<dd><p>Shift the variables in the solver to hotstart the next timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shift_steps</strong> – Number of timesteps to shift.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.opt.opt_base.Optimizer._update_problem_kernel">
<span class="sig-name descname"><span class="pre">_update_problem_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_problems</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_particles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.opt.opt_base.Optimizer._update_problem_kernel" title="Link to this definition"></a></dt>
<dd><p>Update matrix used to map problem index to number of particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_problems</strong> (<em>int</em>) – Number of optimization problems.</p></li>
<li><p><strong>num_particles</strong> (<em>int</em>) – Number of particles per problem.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(250);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>