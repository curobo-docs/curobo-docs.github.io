<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>curobo.wrap.reacher.mpc module - cuRobo</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom_furo.css?v=a13d9812" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-api-pre-name: #76b900;
  --color-api-name: #76b900;
  --color-admonition-title--seealso: #ffffff;
  --color-admonition-title-background--seealso: #448aff;
  --color-admonition-title-background--note: #76b900;
  --color-admonition-title--note: #ffffff;
  --color-brand-primary: #76b900;
  --color-sidebar-background: #f5fff5;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-admonition-title-background--note: #535353;
  --color-admonition-title--note: #ffffff;
  --color-brand-primary: #76b900;
  --color-brand-content: #76b900;
  --color-sidebar-background: #000000;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-admonition-title-background--note: #535353;
  --color-admonition-title--note: #ffffff;
  --color-brand-primary: #76b900;
  --color-brand-content: #76b900;
  --color-sidebar-background: #000000;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">cuRobo</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo-light-mode.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo-dark-mode.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">cuRobo</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../research_index.html">Research</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Research</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../research/research.html">Technical Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../research/research_using_curobo.html">Research using cuRobo</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../get_started_index.html">Get Started</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Get Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../get_started/1_install_instructions.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/1a_quick_overview.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/2a_python_examples.html">Using in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/2b_isaacsim_examples.html">Using with Isaac Sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/2c_world_collision.html">Collision World Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/2d_nvblox_demo.html">Using with Depth Camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/2e_torch_layer_example.html">Using in a Neural Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/4_benchmarks.html">Benchmarks &amp; Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/5_docker_development.html">Docker Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/6_known_issues.html">Known Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/7_api.html">Python API</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced_examples_index.html">Advanced Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Advanced Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced_examples/1_batch_env.html">Batched Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced_examples/2_block_stacking_example.html">Block Stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced_examples/3_constrained_planning.html">Constrained Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced_examples/4_robot_segmentation.html">Robot Segmentation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials_index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/1_robot_configuration.html">Configuring a New Robot</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer_notes_index.html">Developer Notes</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Developer Notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/01_robot_list.html">Supported Robots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/02_numerical_optimization.html">Numerical Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/03_performance_tuning.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/04_cuda_kernels.html">CUDA Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/05_usd_api.html">USD for Robot and World Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/07_environment_variables.html">Environment Variables</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-curobo.wrap.reacher.mpc">
<span id="curobo-wrap-reacher-mpc-module"></span><h1>curobo.wrap.reacher.mpc module<a class="headerlink" href="#module-curobo.wrap.reacher.mpc" title="Link to this heading"></a></h1>
<p>This module contains <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver" title="curobo.wrap.reacher.mpc.MpcSolver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MpcSolver</span></code></a> that provides a high-level interface to for model
predictive control (MPC) for reaching Cartesian poses and also joint configurations while
avoiding obstacles. The solver uses Model Predictive Path Integral (MPPI) optimization as the
solver. MPC only optimizes locally so the robot can get stuck near joint limits or behind
obstacles. To generate global trajectories, use
<a class="reference internal" href="curobo.wrap.reacher.motion_gen.html#curobo.wrap.reacher.motion_gen.MotionGen" title="curobo.wrap.reacher.motion_gen.MotionGen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MotionGen</span></code></a>.</p>
<p>A python example is available at <a class="reference internal" href="../get_started/2a_python_examples.html#python-mpc-example"><span class="std std-ref">Model Predictive Control (MPC)</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Gradient-based MPC is also implemented with L-BFGS but is highly experimental and not
recommended for real robots.</p>
</div>
<p>
<video autoplay="True" loop="True" muted="True" preload="auto" width="100%"><source src="../videos/mpc_clip.mp4" type="video/mp4"></video>
</p><dl class="py class">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolverConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MpcSolverConfig</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.wrap.wrap_mpc.html#curobo.wrap.wrap_mpc.WrapMpc" title="curobo.wrap.wrap_mpc.WrapMpc"><span class="pre">WrapMpc</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">world_coll_checker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.geom.sdf.world.html#curobo.geom.sdf.world.WorldCollision" title="curobo.geom.sdf.world.WorldCollision"><span class="pre">WorldCollision</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">tensor_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><span class="pre">TensorDeviceType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TensorDeviceType(device=device(type='cuda',</span> <span class="pre">index=0),</span> <span class="pre">dtype=torch.float32,</span> <span class="pre">collision_geometry_dtype=torch.float32,</span> <span class="pre">collision_gradient_dtype=torch.float32,</span> <span class="pre">collision_distance_dtype=torch.float32)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph_full_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolverConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Configuration dataclass for MPC.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolverConfig.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.wrap.wrap_mpc.html#curobo.wrap.wrap_mpc.WrapMpc" title="curobo.wrap.wrap_mpc.WrapMpc"><span class="pre">WrapMpc</span></a></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.solver" title="Link to this definition"></a></dt>
<dd><p>MPC Solver.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolverConfig.world_coll_checker">
<span class="sig-name descname"><span class="pre">world_coll_checker</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.geom.sdf.world.html#curobo.geom.sdf.world.WorldCollision" title="curobo.geom.sdf.world.WorldCollision"><span class="pre">WorldCollision</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.world_coll_checker" title="Link to this definition"></a></dt>
<dd><p>World Collision Checker.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolverConfig.tensor_args">
<span class="sig-name descname"><span class="pre">tensor_args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><span class="pre">TensorDeviceType</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">TensorDeviceType(device=device(type='cuda',</span> <span class="pre">index=0),</span> <span class="pre">dtype=torch.float32,</span> <span class="pre">collision_geometry_dtype=torch.float32,</span> <span class="pre">collision_gradient_dtype=torch.float32,</span> <span class="pre">collision_distance_dtype=torch.float32)</span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.tensor_args" title="Link to this definition"></a></dt>
<dd><p>Numeric precision and device to run computations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolverConfig.use_cuda_graph_full_step">
<span class="sig-name descname"><span class="pre">use_cuda_graph_full_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.use_cuda_graph_full_step" title="Link to this definition"></a></dt>
<dd><p>Capture full step in MPC as a single CUDA graph. This is not supported currently.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolverConfig.load_from_robot_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_robot_config</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">robot_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="curobo.types.robot.html#curobo.types.robot.RobotConfig" title="curobo.types.robot.RobotConfig"><span class="pre">RobotConfig</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">world_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="curobo.geom.types.html#curobo.geom.types.WorldConfig" title="curobo.geom.types.WorldConfig"><span class="pre">WorldConfig</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">base_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">tensor_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><span class="pre">TensorDeviceType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TensorDeviceType(device=device(type='cuda',</span> <span class="pre">index=0),</span> <span class="pre">dtype=torch.float32,</span> <span class="pre">collision_geometry_dtype=torch.float32,</span> <span class="pre">collision_gradient_dtype=torch.float32,</span> <span class="pre">collision_distance_dtype=torch.float32)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">compute_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">particle_opt_iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">self_collision_check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">collision_checker_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.geom.sdf.world.html#curobo.geom.sdf.world.CollisionCheckerType" title="curobo.geom.sdf.world.CollisionCheckerType"><span class="pre">CollisionCheckerType</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">CollisionCheckerType.MESH</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_es</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">es_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">store_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph_full_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sync_cuda_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">collision_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">n_collision_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">collision_activation_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">world_coll_checker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">step_dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_lbfgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_mppi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.load_from_robot_config" title="Link to this definition"></a></dt>
<dd><p>Create an MPC solver configuration from robot and world configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>robot_cfg</strong> – Robot configuration. Can be a path to a YAML file or a dictionary or
an instance of <a class="reference internal" href="curobo.types.robot.html#curobo.types.robot.RobotConfig" title="curobo.types.robot.RobotConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RobotConfig</span></code></a>.</p></li>
<li><p><strong>world_model</strong> – World configuration. Can be a path to a YAML file or a dictionary or
an instance of <a class="reference internal" href="curobo.geom.types.html#curobo.geom.types.WorldConfig" title="curobo.geom.types.WorldConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorldConfig</span></code></a>.</p></li>
<li><p><strong>base_cfg</strong> – Base configuration for the solver. This file is used to check constraints
and convergence. If None, the default configuration from <code class="docutils literal notranslate"><span class="pre">base_cfg.yml</span></code> is used.</p></li>
<li><p><strong>tensor_args</strong> – Numeric precision and device to run computations.</p></li>
<li><p><strong>compute_metrics</strong> – Compute metrics on MPC step.</p></li>
<li><p><strong>use_cuda_graph</strong> – Use CUDA graph for the optimization step.</p></li>
<li><p><strong>particle_opt_iters</strong> – Number of iterations for the particle optimization.</p></li>
<li><p><strong>self_collision_check</strong> – Enable self-collision check during MPC optimization.</p></li>
<li><p><strong>collision_checker_type</strong> – Type of collision checker to use. See <a class="reference internal" href="../get_started/2c_world_collision.html#world-collision"><span class="std std-ref">Collision World Representation</span></a>.</p></li>
<li><p><strong>use_es</strong> – Use Evolution Strategies (ES) solver for MPC. Highly experimental.</p></li>
<li><p><strong>es_learning_rate</strong> – Learning rate for ES solver.</p></li>
<li><p><strong>use_cuda_graph_metrics</strong> – Use CUDA graph for computing metrics.</p></li>
<li><p><strong>store_rollouts</strong> – Store rollouts information for debugging. This will also store the
trajectory taken by the end-effector across the horizon.</p></li>
<li><p><strong>use_cuda_graph_full_step</strong> – Capture full step in MPC as a single CUDA graph. This is
experimental and might not work reliably.</p></li>
<li><p><strong>sync_cuda_time</strong> – Synchronize CUDA device with host using
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.cuda.synchronize.html#torch.cuda.synchronize" title="(in PyTorch v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cuda.synchronize</span></code></a> before calculating compute time.</p></li>
<li><p><strong>collision_cache</strong> – Cache of obstacles to create to load obstacles between planning calls.
An example: <code class="docutils literal notranslate"><span class="pre">{&quot;obb&quot;:</span> <span class="pre">10,</span> <span class="pre">&quot;mesh&quot;:</span> <span class="pre">10}</span></code>, to create a cache of 10 cuboids and 10
meshes.</p></li>
<li><p><strong>n_collision_envs</strong> – Number of collision environments to create for batched planning
across different environments. Only used for <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_env</span></code></a>
and <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_env_goalset</span></code></a>.</p></li>
<li><p><strong>collision_activation_distance</strong> – Distance in meters to activate collision cost. A good
value to start with is 0.01 meters. Increase the distance if the robot needs to
stay further away from obstacles.</p></li>
<li><p><strong>world_coll_checker</strong> – Instance of world collision checker to use for MPC. Leaving this to
None will create a new instance of world collision checker using the provided
<code class="xref py py-attr docutils literal notranslate"><span class="pre">world_model</span></code>.</p></li>
<li><p><strong>step_dt</strong> – Time step to use between each step in the trajectory. If None, the default
time step from the configuration~(<cite>particle_mpc.yml</cite> or <cite>gradient_mpc.yml</cite>)
is used. This dt should match the control frequency at which you are sending
commands to the robot. This dt should also be greater than than the compute
time for a single step.</p></li>
<li><p><strong>use_lbfgs</strong> – Use L-BFGS solver for MPC. Highly experimental.</p></li>
<li><p><strong>use_mppi</strong> – Use MPPI solver for MPC.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configuration for the MPC solver.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig" title="curobo.wrap.reacher.mpc.MpcSolverConfig">MpcSolverConfig</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MpcSolver</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig" title="curobo.wrap.reacher.mpc.MpcSolverConfig"><span class="pre">MpcSolverConfig</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig" title="curobo.wrap.reacher.mpc.MpcSolverConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MpcSolverConfig</span></code></a></p>
<p>High-level interface for Model Predictive Control (MPC).</p>
<p>MPC can reach Cartesian poses and joint configurations while avoiding obstacles. The solver
uses Model Predictive Path Integral (MPPI) optimization as the solver. MPC only optimizes
locally so the robot can get stuck near joint limits or behind obstacles. To generate global
trajectories, use <a class="reference internal" href="curobo.wrap.reacher.motion_gen.html#curobo.wrap.reacher.motion_gen.MotionGen" title="curobo.wrap.reacher.motion_gen.MotionGen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MotionGen</span></code></a>.</p>
<p>See <a class="reference internal" href="../get_started/2a_python_examples.html#python-mpc-example"><span class="std std-ref">Model Predictive Control (MPC)</span></a> for an example. This MPC solver implementation can be used in the
following steps:</p>
<ol class="arabic simple">
<li><p>Create a <a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Goal</span></code></a> object with the target pose or joint
configuration.</p></li>
<li><p>Create a goal buffer for the problem type using <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_single" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_single"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_solve_single</span></code></a>,
<a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_goalset" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_goalset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_solve_goalset</span></code></a>, <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_solve_batch</span></code></a>, <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_goalset" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_goalset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_solve_batch_goalset</span></code></a>,
<a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_solve_batch_env</span></code></a>, or <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_solve_batch_env_goalset</span></code></a>. Pass the goal
object from the previous step to this function. This function will update the internal
solve state of MPC and also the goal for MPC. An augmented goal buffer is returned.</p></li>
<li><p>Call <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.step" title="curobo.wrap.reacher.mpc.MpcSolver.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step</span></code></a> with the current joint state to get the next action.</p></li>
<li><p>To change the goal, create a <a class="reference internal" href="curobo.types.math.html#curobo.types.math.Pose" title="curobo.types.math.Pose"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pose</span></code></a> object with new pose or
<a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><code class="xref py py-class docutils literal notranslate"><span class="pre">JointState</span></code></a> object with new joint configuration. Then
copy the target into the augmented goal buffer using
<code class="docutils literal notranslate"><span class="pre">goal_buffer.goal_pose.copy_(new_pose)</span></code> or <code class="docutils literal notranslate"><span class="pre">goal_buffer.goal_state.copy_(new_state)</span></code>.</p></li>
<li><p>Call <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.update_goal" title="curobo.wrap.reacher.mpc.MpcSolver.update_goal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_goal</span></code></a> with the augmented goal buffer to update the goal for MPC.</p></li>
<li><p>Call <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.step" title="curobo.wrap.reacher.mpc.MpcSolver.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step</span></code></a> with the current joint state to get the next action.</p></li>
</ol>
<p>To dynamically change the type of goal reached between pose and joint configuration targets,
create the goal object in step 1 with both targets and then use <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.enable_cspace_cost" title="curobo.wrap.reacher.mpc.MpcSolver.enable_cspace_cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_cspace_cost</span></code></a> and
<a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.enable_pose_cost" title="curobo.wrap.reacher.mpc.MpcSolver.enable_pose_cost"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_pose_cost</span></code></a> to enable or disable reaching joint configuration cost and pose cost.</p>
<p>Initializes the MPC solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Configuration parameters for MPC.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.tensor_args">
<span class="sig-name descname"><span class="pre">tensor_args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><span class="pre">TensorDeviceType</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">TensorDeviceType(device=device(type='cuda',</span> <span class="pre">index=0),</span> <span class="pre">dtype=torch.float32,</span> <span class="pre">collision_geometry_dtype=torch.float32,</span> <span class="pre">collision_gradient_dtype=torch.float32,</span> <span class="pre">collision_distance_dtype=torch.float32)</span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.tensor_args" title="Link to this definition"></a></dt>
<dd><p>Numeric precision and device to run computations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_single">
<span class="sig-name descname"><span class="pre">setup_solve_single</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_single" title="Link to this definition"></a></dt>
<dd><p>Creates a goal buffer to solve for a robot to reach target pose or joint configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>goal</strong> – goal object containing target pose or joint configuration.</p></li>
<li><p><strong>num_seeds</strong> – Number of seeds to use in the solver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of augmented goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_goalset">
<span class="sig-name descname"><span class="pre">setup_solve_goalset</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_goalset" title="Link to this definition"></a></dt>
<dd><p>Creates a goal buffer to solve for a robot to reach a pose in a set of poses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>goal</strong> – goal object containing target goalset or joint configuration.</p></li>
<li><p><strong>num_seeds</strong> – Number of seeds to use in the solver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of augmented goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch">
<span class="sig-name descname"><span class="pre">setup_solve_batch</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch" title="Link to this definition"></a></dt>
<dd><p>Creates a goal buffer to solve for a batch of robots to reach targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>goal</strong> – goal object containing target poses or joint configurations.</p></li>
<li><p><strong>num_seeds</strong> – Number of seeds to use in the solver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of augmented goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_goalset">
<span class="sig-name descname"><span class="pre">setup_solve_batch_goalset</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_goalset" title="Link to this definition"></a></dt>
<dd><p>Creates a goal buffer to solve for a batch of robots to reach a set of poses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>goal</strong> – goal object containing target goalset or joint configurations.</p></li>
<li><p><strong>num_seeds</strong> – Number of seeds to use in the solver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of augmented goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env">
<span class="sig-name descname"><span class="pre">setup_solve_batch_env</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env" title="Link to this definition"></a></dt>
<dd><p>Creates a goal buffer to solve for a batch of robots in different collision worlds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>goal</strong> – goal object containing target poses or joint configurations.</p></li>
<li><p><strong>num_seeds</strong> – Number of seeds to use in the solver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of augmented goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset">
<span class="sig-name descname"><span class="pre">setup_solve_batch_env_goalset</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset" title="Link to this definition"></a></dt>
<dd><p>Creates a goal buffer to solve for a batch of robots in different collision worlds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>goal</strong> – goal object containing target goalset or joint configurations.</p></li>
<li><p><strong>num_seeds</strong> – Number of seeds to use in the solver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of augmented goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">current_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.step" title="Link to this definition"></a></dt>
<dd><p>Solve for the next action given the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_state</strong> – Current joint state of the robot.</p></li>
<li><p><strong>shift_steps</strong> – Number of steps to shift the trajectory.</p></li>
<li><p><strong>seed_traj</strong> – Initial trajectory to seed the optimization. If None, the solver
uses the solution from the previous step.</p></li>
<li><p><strong>max_attempts</strong> – Maximum number of attempts to solve the problem.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.wrap.wrap_base.html#curobo.wrap.wrap_base.WrapResult" title="curobo.wrap.wrap_base.WrapResult">WrapResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.update_goal">
<span class="sig-name descname"><span class="pre">update_goal</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.update_goal" title="Link to this definition"></a></dt>
<dd><p>Update the goal for MPC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>goal</strong> – goal object containing target pose or joint configuration. This goal instance
should be created using one of the setup_solve functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the solver.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.reset_cuda_graph">
<span class="sig-name descname"><span class="pre">reset_cuda_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.reset_cuda_graph" title="Link to this definition"></a></dt>
<dd><p>Reset captured CUDA graph. This does not work.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.enable_cspace_cost">
<span class="sig-name descname"><span class="pre">enable_cspace_cost</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">enable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.enable_cspace_cost" title="Link to this definition"></a></dt>
<dd><p>Enable or disable reaching joint configuration cost in the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>enable</strong> – Enable or disable reaching joint configuration cost. When False, cspace cost
is disabled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.enable_pose_cost">
<span class="sig-name descname"><span class="pre">enable_pose_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.enable_pose_cost" title="Link to this definition"></a></dt>
<dd><p>Enable or disable reaching pose cost in the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>enable</strong> – Enable or disable reaching pose cost. When False, pose cost is disabled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.get_active_js">
<span class="sig-name descname"><span class="pre">get_active_js</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">in_js</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.get_active_js" title="Link to this definition"></a></dt>
<dd><p>Get controlled joints indexed in MPC order from the input joint state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_js</strong> – Input joint state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Joint state with controlled joints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState">JointState</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.update_world">
<span class="sig-name descname"><span class="pre">update_world</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">world</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.geom.types.html#curobo.geom.types.WorldConfig" title="curobo.geom.types.WorldConfig"><span class="pre">WorldConfig</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.update_world" title="Link to this definition"></a></dt>
<dd><p>Update the collision world for the solver.</p>
<p>This allows for updating the world representation as long as the new world representation
does not have a larger number of obstacles than the <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.collision_cache" title="curobo.wrap.reacher.mpc.MpcSolver.collision_cache"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MpcSolver.collision_cache</span></code></a> as
created during initialization of <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig" title="curobo.wrap.reacher.mpc.MpcSolverConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MpcSolverConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>world</strong> – New collision world configuration. See <a class="reference internal" href="../get_started/2c_world_collision.html#world-collision"><span class="std std-ref">Collision World Representation</span></a> for more details.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.get_visual_rollouts">
<span class="sig-name descname"><span class="pre">get_visual_rollouts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.get_visual_rollouts" title="Link to this definition"></a></dt>
<dd><p>Get rollouts for debugging.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.joint_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">joint_names</span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.joint_names" title="Link to this definition"></a></dt>
<dd><p>Get the ordered joint names of the robot.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.collision_cache">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collision_cache</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.collision_cache" title="Link to this definition"></a></dt>
<dd><p>Returns the collision cache created by the world collision checker.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.kinematics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kinematics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.cuda_robot_model.cuda_robot_model.html#curobo.cuda_robot_model.cuda_robot_model.CudaRobotModel" title="curobo.cuda_robot_model.cuda_robot_model.CudaRobotModel"><span class="pre">CudaRobotModel</span></a></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.kinematics" title="Link to this definition"></a></dt>
<dd><p>Get kinematics instance of the robot.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.world_collision">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">world_collision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.geom.sdf.world.html#curobo.geom.sdf.world.WorldCollision" title="curobo.geom.sdf.world.WorldCollision"><span class="pre">WorldCollision</span></a></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.world_collision" title="Link to this definition"></a></dt>
<dd><p>Get the world collision checker.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.rollout_fn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rollout_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.rollout.arm_reacher.html#curobo.rollout.arm_reacher.ArmReacher" title="curobo.rollout.arm_reacher.ArmReacher"><span class="pre">ArmReacher</span></a></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.rollout_fn" title="Link to this definition"></a></dt>
<dd><p>Get the rollout function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver._step_once">
<span class="sig-name descname"><span class="pre">_step_once</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">current_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.wrap.wrap_base.html#curobo.wrap.wrap_base.WrapResult" title="curobo.wrap.wrap_base.WrapResult"><span class="pre">WrapResult</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver._step_once" title="Link to this definition"></a></dt>
<dd><p>Solve for the next action given the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_state</strong> – Current joint state of the robot.</p></li>
<li><p><strong>shift_steps</strong> – Number of steps to shift the trajectory.</p></li>
<li><p><strong>seed_traj</strong> – Initial trajectory to seed the optimization. If None, the solver
uses the solution from the previous step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.wrap.wrap_base.html#curobo.wrap.wrap_base.WrapResult" title="curobo.wrap.wrap_base.WrapResult">WrapResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver._update_solve_state_and_goal_buffer">
<span class="sig-name descname"><span class="pre">_update_solve_state_and_goal_buffer</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">solve_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.wrap.reacher.types.html#curobo.wrap.reacher.types.ReacherSolveState" title="curobo.wrap.reacher.types.ReacherSolveState"><span class="pre">ReacherSolveState</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver._update_solve_state_and_goal_buffer" title="Link to this definition"></a></dt>
<dd><p>Update solve state and goal for MPC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solve_state</strong> – New solve state.</p></li>
<li><p><strong>goal</strong> – New goal buffer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated goal buffer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal">Goal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver._update_batch_size">
<span class="sig-name descname"><span class="pre">_update_batch_size</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver._update_batch_size" title="Link to this definition"></a></dt>
<dd><p>Update the batch size of the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> – Number of problems to solve in parallel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver._solve_from_solve_state">
<span class="sig-name descname"><span class="pre">_solve_from_solve_state</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">solve_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.wrap.reacher.types.html#curobo.wrap.reacher.types.ReacherSolveState" title="curobo.wrap.reacher.types.ReacherSolveState"><span class="pre">ReacherSolveState</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.rollout.rollout_base.html#curobo.rollout.rollout_base.Goal" title="curobo.rollout.rollout_base.Goal"><span class="pre">Goal</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="curobo.wrap.wrap_base.html#curobo.wrap.wrap_base.WrapResult" title="curobo.wrap.wrap_base.WrapResult"><span class="pre">WrapResult</span></a></span></span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver._solve_from_solve_state" title="Link to this definition"></a></dt>
<dd><p>Solve for the next action given the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solve_state</strong> – solve state object containing information about the current MPC problem.</p></li>
<li><p><strong>goal</strong> – goal object containing target pose or joint configuration.</p></li>
<li><p><strong>shift_steps</strong> – Number of steps to shift the trajectory before optimization.</p></li>
<li><p><strong>seed_traj</strong> – Initial trajectory to seed the optimization. If None, the solver
uses the solution from the previous step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.wrap.wrap_base.html#curobo.wrap.wrap_base.WrapResult" title="curobo.wrap.wrap_base.WrapResult">WrapResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver._mpc_step">
<span class="sig-name descname"><span class="pre">_mpc_step</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">current_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver._mpc_step" title="Link to this definition"></a></dt>
<dd><p>One step function that is used to create a CUDA graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_state</strong> – Current joint state of the robot.</p></li>
<li><p><strong>shift_steps</strong> – Number of steps to shift the trajectory.</p></li>
<li><p><strong>seed_traj</strong> – Initial trajectory to seed the optimization. If None, the solver
uses the solution from the previous step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="curobo.wrap.wrap_base.html#curobo.wrap.wrap_base.WrapResult" title="curobo.wrap.wrap_base.WrapResult">WrapResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver._initialize_cuda_graph_step">
<span class="sig-name descname"><span class="pre">_initialize_cuda_graph_step</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">current_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.state.html#curobo.types.state.JointState" title="curobo.types.state.JointState"><span class="pre">JointState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver._initialize_cuda_graph_step" title="Link to this definition"></a></dt>
<dd><p>Create a CUDA graph for the full step of MPC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_state</strong> – Current joint state of the robot.</p></li>
<li><p><strong>shift_steps</strong> – Number of steps to shift the trajectory.</p></li>
<li><p><strong>seed_traj</strong> – Initial trajectory to seed the optimization. If None, the solver
uses the solution from the previous step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.load_from_robot_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_robot_config</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">robot_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="curobo.types.robot.html#curobo.types.robot.RobotConfig" title="curobo.types.robot.RobotConfig"><span class="pre">RobotConfig</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">world_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="curobo.geom.types.html#curobo.geom.types.WorldConfig" title="curobo.geom.types.WorldConfig"><span class="pre">WorldConfig</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">base_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">tensor_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.types.base.html#curobo.types.base.TensorDeviceType" title="curobo.types.base.TensorDeviceType"><span class="pre">TensorDeviceType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TensorDeviceType(device=device(type='cuda',</span> <span class="pre">index=0),</span> <span class="pre">dtype=torch.float32,</span> <span class="pre">collision_geometry_dtype=torch.float32,</span> <span class="pre">collision_gradient_dtype=torch.float32,</span> <span class="pre">collision_distance_dtype=torch.float32)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">compute_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">particle_opt_iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">self_collision_check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">collision_checker_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="curobo.geom.sdf.world.html#curobo.geom.sdf.world.CollisionCheckerType" title="curobo.geom.sdf.world.CollisionCheckerType"><span class="pre">CollisionCheckerType</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">CollisionCheckerType.MESH</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_es</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">es_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">store_rollouts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_cuda_graph_full_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sync_cuda_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">collision_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">n_collision_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">collision_activation_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">world_coll_checker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">step_dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_lbfgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_mppi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.load_from_robot_config" title="Link to this definition"></a></dt>
<dd><p>Create an MPC solver configuration from robot and world configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>robot_cfg</strong> – Robot configuration. Can be a path to a YAML file or a dictionary or
an instance of <a class="reference internal" href="curobo.types.robot.html#curobo.types.robot.RobotConfig" title="curobo.types.robot.RobotConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RobotConfig</span></code></a>.</p></li>
<li><p><strong>world_model</strong> – World configuration. Can be a path to a YAML file or a dictionary or
an instance of <a class="reference internal" href="curobo.geom.types.html#curobo.geom.types.WorldConfig" title="curobo.geom.types.WorldConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorldConfig</span></code></a>.</p></li>
<li><p><strong>base_cfg</strong> – Base configuration for the solver. This file is used to check constraints
and convergence. If None, the default configuration from <code class="docutils literal notranslate"><span class="pre">base_cfg.yml</span></code> is used.</p></li>
<li><p><strong>tensor_args</strong> – Numeric precision and device to run computations.</p></li>
<li><p><strong>compute_metrics</strong> – Compute metrics on MPC step.</p></li>
<li><p><strong>use_cuda_graph</strong> – Use CUDA graph for the optimization step.</p></li>
<li><p><strong>particle_opt_iters</strong> – Number of iterations for the particle optimization.</p></li>
<li><p><strong>self_collision_check</strong> – Enable self-collision check during MPC optimization.</p></li>
<li><p><strong>collision_checker_type</strong> – Type of collision checker to use. See <a class="reference internal" href="../get_started/2c_world_collision.html#world-collision"><span class="std std-ref">Collision World Representation</span></a>.</p></li>
<li><p><strong>use_es</strong> – Use Evolution Strategies (ES) solver for MPC. Highly experimental.</p></li>
<li><p><strong>es_learning_rate</strong> – Learning rate for ES solver.</p></li>
<li><p><strong>use_cuda_graph_metrics</strong> – Use CUDA graph for computing metrics.</p></li>
<li><p><strong>store_rollouts</strong> – Store rollouts information for debugging. This will also store the
trajectory taken by the end-effector across the horizon.</p></li>
<li><p><strong>use_cuda_graph_full_step</strong> – Capture full step in MPC as a single CUDA graph. This is
experimental and might not work reliably.</p></li>
<li><p><strong>sync_cuda_time</strong> – Synchronize CUDA device with host using
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.cuda.synchronize.html#torch.cuda.synchronize" title="(in PyTorch v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cuda.synchronize</span></code></a> before calculating compute time.</p></li>
<li><p><strong>collision_cache</strong> – Cache of obstacles to create to load obstacles between planning calls.
An example: <code class="docutils literal notranslate"><span class="pre">{&quot;obb&quot;:</span> <span class="pre">10,</span> <span class="pre">&quot;mesh&quot;:</span> <span class="pre">10}</span></code>, to create a cache of 10 cuboids and 10
meshes.</p></li>
<li><p><strong>n_collision_envs</strong> – Number of collision environments to create for batched planning
across different environments. Only used for <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_env</span></code></a>
and <a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset" title="curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_env_goalset</span></code></a>.</p></li>
<li><p><strong>collision_activation_distance</strong> – Distance in meters to activate collision cost. A good
value to start with is 0.01 meters. Increase the distance if the robot needs to
stay further away from obstacles.</p></li>
<li><p><strong>world_coll_checker</strong> – Instance of world collision checker to use for MPC. Leaving this to
None will create a new instance of world collision checker using the provided
<code class="xref py py-attr docutils literal notranslate"><span class="pre">world_model</span></code>.</p></li>
<li><p><strong>step_dt</strong> – Time step to use between each step in the trajectory. If None, the default
time step from the configuration~(<cite>particle_mpc.yml</cite> or <cite>gradient_mpc.yml</cite>)
is used. This dt should match the control frequency at which you are sending
commands to the robot. This dt should also be greater than than the compute
time for a single step.</p></li>
<li><p><strong>use_lbfgs</strong> – Use L-BFGS solver for MPC. Highly experimental.</p></li>
<li><p><strong>use_mppi</strong> – Use MPPI solver for MPC.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configuration for the MPC solver.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig" title="curobo.wrap.reacher.mpc.MpcSolverConfig">MpcSolverConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.use_cuda_graph_full_step">
<span class="sig-name descname"><span class="pre">use_cuda_graph_full_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.use_cuda_graph_full_step" title="Link to this definition"></a></dt>
<dd><p>Capture full step in MPC as a single CUDA graph. This is not supported currently.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.world_coll_checker">
<span class="sig-name descname"><span class="pre">world_coll_checker</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.geom.sdf.world.html#curobo.geom.sdf.world.WorldCollision" title="curobo.geom.sdf.world.WorldCollision"><span class="pre">WorldCollision</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.world_coll_checker" title="Link to this definition"></a></dt>
<dd><p>World Collision Checker.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="curobo.wrap.reacher.mpc.MpcSolver.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="curobo.wrap.wrap_mpc.html#curobo.wrap.wrap_mpc.WrapMpc" title="curobo.wrap.wrap_mpc.WrapMpc"><span class="pre">WrapMpc</span></a></em><a class="headerlink" href="#curobo.wrap.reacher.mpc.MpcSolver.solver" title="Link to this definition"></a></dt>
<dd><p>MPC Solver.</p>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023-2024, NVIDIA
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/NVLabs/curobo" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">curobo.wrap.reacher.mpc module</a><ul>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig"><code class="docutils literal notranslate"><span class="pre">MpcSolverConfig</span></code></a><ul>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.solver"><code class="docutils literal notranslate"><span class="pre">MpcSolverConfig.solver</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.world_coll_checker"><code class="docutils literal notranslate"><span class="pre">MpcSolverConfig.world_coll_checker</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.tensor_args"><code class="docutils literal notranslate"><span class="pre">MpcSolverConfig.tensor_args</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.use_cuda_graph_full_step"><code class="docutils literal notranslate"><span class="pre">MpcSolverConfig.use_cuda_graph_full_step</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolverConfig.load_from_robot_config"><code class="docutils literal notranslate"><span class="pre">MpcSolverConfig.load_from_robot_config</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver"><code class="docutils literal notranslate"><span class="pre">MpcSolver</span></code></a><ul>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.tensor_args"><code class="docutils literal notranslate"><span class="pre">MpcSolver.tensor_args</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_single"><code class="docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_single</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_goalset"><code class="docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_goalset</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch"><code class="docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_goalset"><code class="docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_goalset</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env"><code class="docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_env</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.setup_solve_batch_env_goalset"><code class="docutils literal notranslate"><span class="pre">MpcSolver.setup_solve_batch_env_goalset</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.step"><code class="docutils literal notranslate"><span class="pre">MpcSolver.step</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.update_goal"><code class="docutils literal notranslate"><span class="pre">MpcSolver.update_goal</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.reset"><code class="docutils literal notranslate"><span class="pre">MpcSolver.reset</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.reset_cuda_graph"><code class="docutils literal notranslate"><span class="pre">MpcSolver.reset_cuda_graph</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.enable_cspace_cost"><code class="docutils literal notranslate"><span class="pre">MpcSolver.enable_cspace_cost</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.enable_pose_cost"><code class="docutils literal notranslate"><span class="pre">MpcSolver.enable_pose_cost</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.get_active_js"><code class="docutils literal notranslate"><span class="pre">MpcSolver.get_active_js</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.update_world"><code class="docutils literal notranslate"><span class="pre">MpcSolver.update_world</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.get_visual_rollouts"><code class="docutils literal notranslate"><span class="pre">MpcSolver.get_visual_rollouts</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.joint_names"><code class="docutils literal notranslate"><span class="pre">MpcSolver.joint_names</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.collision_cache"><code class="docutils literal notranslate"><span class="pre">MpcSolver.collision_cache</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.kinematics"><code class="docutils literal notranslate"><span class="pre">MpcSolver.kinematics</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.world_collision"><code class="docutils literal notranslate"><span class="pre">MpcSolver.world_collision</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.rollout_fn"><code class="docutils literal notranslate"><span class="pre">MpcSolver.rollout_fn</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver._step_once"><code class="docutils literal notranslate"><span class="pre">MpcSolver._step_once</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver._update_solve_state_and_goal_buffer"><code class="docutils literal notranslate"><span class="pre">MpcSolver._update_solve_state_and_goal_buffer</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver._update_batch_size"><code class="docutils literal notranslate"><span class="pre">MpcSolver._update_batch_size</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver._solve_from_solve_state"><code class="docutils literal notranslate"><span class="pre">MpcSolver._solve_from_solve_state</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver._mpc_step"><code class="docutils literal notranslate"><span class="pre">MpcSolver._mpc_step</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver._initialize_cuda_graph_step"><code class="docutils literal notranslate"><span class="pre">MpcSolver._initialize_cuda_graph_step</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.load_from_robot_config"><code class="docutils literal notranslate"><span class="pre">MpcSolver.load_from_robot_config</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.use_cuda_graph_full_step"><code class="docutils literal notranslate"><span class="pre">MpcSolver.use_cuda_graph_full_step</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.world_coll_checker"><code class="docutils literal notranslate"><span class="pre">MpcSolver.world_coll_checker</span></code></a></li>
<li><a class="reference internal" href="#curobo.wrap.reacher.mpc.MpcSolver.solver"><code class="docutils literal notranslate"><span class="pre">MpcSolver.solver</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=916ae6f7"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>